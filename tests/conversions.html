<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<title>Color conversion tests</title>
<link rel="stylesheet" href="https://test.mavo.io/style.css" />
<script src="https://blissfuljs.com/bliss.shy.js"></script>
<script src="https://test.mavo.io/test.js"></script>

<script src="../color.js" type="module"></script>
<script src="../src/spaces/hwb.js" type="module"></script>
<script>

</script>

</head>
<body>

<h1>Color conversion Tests</h1>
<p>These tests parse different color formats and then print out the coordinates in various color spaces.</p>

<section>
	<h1>sRGB to LCH</h1>
	<table class="reftest" data-test="colorConvertLCH" data-columns="3">
		<tr>
			<td>slategray</td>
			<td>52.69726481080971, 11.234142037623341, 253.00052666481292</td>
		</tr>
	</table>
</section>

<section>
	<h1>HWB to sRGB</h1>
	<table class="reftest" data-test="fuzzyNumbers" data-columns="3">
		<tr>
			<td>hwb(0 20% 40%)</td>
			<td>
				<script>
					let td = document.currentScript.parentNode.previousElementSibling;
					print(() => {
						var color = new Color(td.textContent);
						return color.to("srgb").coords.join(", ");
					});
				</script>
			</td>
			<td><!--#993333--> 0.6, 0.2, 0.2</td>
		</tr>
	</table>
</section>

<section>
	<h1>Get coordinates</h1>
	<table class="reftest" data-test="fuzzyNumbers">
		<tr title="color.chroma">
			<td>
				<script>
					print(() => {
						var color = new Color("slategray");
						return color.chroma
					});
				</script>
			</td>
			<td>11.234142037623341</td>
		</tr>
		<tr title="color.lch[1]">
			<td>
				<script>
					print(() => {
						var color = new Color("slategray");
						return color.lch[1];
					});
				</script>
			</td>
			<td>11.234142037623341</td>
		</tr>
		<tr title="color.lch.chroma">
			<td>
				<script>
					print(() => {
						var color = new Color("slategray");
						return color.lch.chroma;
					});
				</script>
			</td>
			<td>11.234142037623341</td>
		</tr>
	</table>
</section>

<script>
function colorConvertLCH(...rest) {
	return colorConvert("lch", ...rest);
}

function colorConvert(id, test, result, expected) {
	var err;

	try {
		var color = new Color(test.textContent);
		let coords = color[id];
		result.textContent = Array.isArray(coords)? coords.join(", ") : coords;
		result.color = color;

		if (Test.equals(result.textContent, expected.textContent)) {
			return true;
		}
	}
	catch(e) {
		result.textContent = result.color = err = e;
	}

	return err || false;
}
</script>

</body>
</html>
